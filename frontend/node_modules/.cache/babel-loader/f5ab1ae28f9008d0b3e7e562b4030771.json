{"ast":null,"code":"import _slicedToArray from\"/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/Text-Cluster-Explainer/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/Text-Cluster-Explainer/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import*as d3 from\"d3\";// Storing state location data for quicker access\n/*\n  Schema:\n  database = {\n    id: {\n      cx: float\n      cy: float\n      label: string\n      originalColor: color\n    }\n  }\n  */ // Global variables\nvar database={};// Database of projected points\nvar colorMap={};// Map of label --> color\nvar globalOpacity=0.5;// Default opacity\nvar globalDotSize=2;// Default dot size\nvar dataset=\"\";// Clears SVG in the center panel when new data is uploaded\nfunction clearSVG(){var svg=d3.select(\"#containerSVG\");svg.selectAll(\"circle\").remove();// Removes plotted points\nsvg.selectAll(\"#lasso\").attr(\"d\",\"\");// Resets lasso\n}// Function to draw projection, called once at render time and when new data is uploaded\n/*\n  Schema:\n  width = float\n  height = float\n  uploadedData = [x, y, label, color(if color column selected)]\n*/function drawProjection(width,height,uploadedData){var data=JSON.parse(JSON.stringify(uploadedData));// Location var\nvar MARGIN={top:20,right:0,bottom:50,left:85},SVG_X=width,SVG_Y=height,PLOT_X=SVG_X-MARGIN.right-MARGIN.left,PLOT_Y=SVG_Y-MARGIN.top-MARGIN.bottom;var x=d3.scaleLinear().range([MARGIN.left,PLOT_X]),y=d3.scaleLinear().range([PLOT_Y,MARGIN.top]);// SVG\nvar svg=d3.select(\"#containerSVG\");//.call(d3.zoom().on(\"zoom\", function handleZoom(event) { svg.attr(\"transform\",event.transform) }));\n//d3.select(\"#containerSVG\").on('mousedown.zoom',null);\n// Re-setting database and colorMap and using uploaded data to draw when data has been loaded\ndatabase={};colorMap={};console.log(data[0]);if(data[0].length===6){makeColorMap(data);}var d_extent_x=d3.extent(data,function(d){return+d[0];}),d_extent_y=d3.extent(data,function(d){return+d[1];});// Draw axes\nx.domain(d_extent_x);y.domain(d_extent_y);// Generate IDs for points\nvar _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var row=_step.value;row.push(makeid(10));}// Draw circles\n}catch(err){_iterator.e(err);}finally{_iterator.f();}svg.selectAll(\"circle\").data(data).enter().append(\"g\").append(\"circle\").attr(\"r\",globalDotSize).attr(\"opacity\",globalOpacity).attr(\"id\",function(d){var id=d[d.length-1];database[id]={label:d[2],keyword:d[4]};return id;}).attr(\"cx\",function(d){var centerX=x(+d[0]);database[d[d.length-1]].cx=centerX;return centerX;}).attr(\"cy\",function(d){var centerY=y(+d[1]);database[d[d.length-1]].cy=centerY;return centerY;}).attr(\"fill\",function(d){if(d.length===7){return assignColor(d[3],d[6]);}else{database[d[d.length-1]].originalColor=\"black\";return\"black\";}}).attr(\"class\",\"non-brushed\");colorMap.x=x;colorMap.y=y;console.log(colorMap,x,y);//svg.append(\"g\");\nshowKeywords(colorMap);return colorMap;}function drawTestProjection(data){d3.select(\"#test_text\").remove();var svg2=d3.select(\"#containerSVG\").raise();var x=colorMap.x;var y=colorMap.y;console.log(x,y);var id=\"test_text\";// Draw circles\nsvg2.append(\"g\").selectAll(\"circle\").data(data).enter().append(\"circle\").attr(\"r\",0).attr(\"opacity\",1).attr(\"id\",id).attr(\"cx\",function(d){var centerX=x(+d[0]);return centerX;}).attr(\"cy\",function(d){var centerY=y(+d[1]);return centerY;}).attr(\"fill\",'green').attr(\"class\",\"non-brushed\").transition().duration(200).attr(\"r\",10);}function makeColorMap(data){var uniqueCategories=new Set();var uniqueKeywords=new Set();var uniqueClusterCentroids=new Set();var _iterator2=_createForOfIteratorHelper(data),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;if(uniqueCategories.has(item[3])){continue;}else{uniqueCategories.add(item[3]);uniqueKeywords.add(item[4]);uniqueClusterCentroids.add(item[5]);}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var categoriesArray=Array.from(uniqueCategories);var keywordsArray=Array.from(uniqueKeywords);var centroidsArray=Array.from(uniqueClusterCentroids);for(var i=0;i<categoriesArray.length;i++){colorMap[categoriesArray[i]]=[COLORS[i%11],keywordsArray[i],JSON.parse(centroidsArray[i])];}}var COLORS=['#e6194B','#3cb44b','#ffe119','#4363d8','#f58231','#911eb4','#42d4f4','#f032e6','#bfef45','#fabed4','#469990','#dcbeff','#9A6324','#fffac8','#800000','#aaffc3','#808000','#ffd8b1','#000075','#a9a9a9','#ffffff','#000000'];function assignColor(category,id){database[id].category=category;database[id].originalColor=colorMap[category][0];return colorMap[category][0];}// Displays dots based on if the checkbox corresponding to their color is checked\nfunction toggleDotDisplay(checked,label){d3.selectAll(\"circle\").filter(function(){if(database[d3.select(this).attr(\"id\")]){return database[d3.select(this).attr(\"id\")].category===+label;}else{return false;}}).transition().duration(200).attr(\"visibility\",function(){if(checked){return\"visible\";}else{return\"hidden\";}}).attr(\"opacity\",function(){if(checked){return\"1\";}else{return\"0\";}});}// Check if points are within path on mouseup\nfunction checkPoints(){var path=document.getElementById(\"lasso\");var svg=document.getElementsByTagName(\"svg\")[0];var brushedPoints=[];var categorizedPoints=[];var selectedLabels=[];// d3.polygonContains(lassoPolygon, [x, y]);\nvar _loop=function _loop(){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),id=_Object$entries$_i[0],idInfo=_Object$entries$_i[1];// Ignores point if it's not currently displayed\nif(d3.select(\"#\"+id).attr(\"visibility\")===\"hidden\"){return\"continue\";}var point=svg.createSVGPoint();point.x=idInfo.cx;point.y=idInfo.cy;// Check if point is in path\nif(path.isPointInFill(point)){idInfo.id=id;brushedPoints.push(idInfo);categorizedPoints.push([idInfo.label,1]);selectedLabels.push(idInfo.label);// Change class and recolor points accordingly\nvar selector=\"#\"+id;d3.selectAll(selector).attr(\"class\",function(){var CURRENT_CLASS=d3.select(this).attr(\"class\");if(CURRENT_CLASS.includes(\"brushed\")){return CURRENT_CLASS;}else{return\"brushed\";}}).attr(\"fill\",function(d,i,elements){var color=database[id].originalColor;if(d3.select(elements[i]).attr(\"class\").includes(\"brushed\")){if(Object.entries(colorMap).length>0){color=\"black\";//color = \"red\"\n}else{color=\"orange\";}}return color;});}else categorizedPoints.push([idInfo.label,0]);};for(var _i=0,_Object$entries=Object.entries(database);_i<_Object$entries.length;_i++){var _ret=_loop();if(_ret===\"continue\")continue;}return{brushedPoints:brushedPoints,categorizedPoints:categorizedPoints,selectedLabels:selectedLabels};}function autocheckPoints(label){console.log(\"in auto checkpoints\");var brushedPoints=[];var categorizedPoints=[];var selectedLabels=[];// d3.polygonContains(lassoPolygon, [x, y]);\nfor(var _i2=0,_Object$entries2=Object.entries(database);_i2<_Object$entries2.length;_i2++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),id=_Object$entries2$_i[0],idInfo=_Object$entries2$_i[1];// Ignores point if it's not currently displayed\nvar selector=\"#\"+id;if(database[id].category===+label){idInfo.id=id;brushedPoints.push(idInfo);categorizedPoints.push([idInfo.label,1]);selectedLabels.push(idInfo.label);d3.selectAll(selector).transition().duration(200).attr('r',3*globalDotSize).attr(\"opacity\",1);}else{categorizedPoints.push([idInfo.label,0]);d3.selectAll(selector).transition().duration(200).attr('r',globalDotSize).attr(\"opacity\",globalOpacity);}}return{brushedPoints:brushedPoints,categorizedPoints:categorizedPoints,selectedLabels:selectedLabels};}// Reset projection to original state\nfunction reset(){// Remove word clouds\nd3.select(\"#positive-cloud\").remove();d3.select(\"#negative-cloud\").remove();// Re-color points\nd3.selectAll(\"circle\").filter(function(){if(d3.select(this).attr(\"class\").includes(\"matches-substring\")){return false;}else{return true;}}).attr(\"class\",\"prev-brushed\").transition().duration(200)//.attr(\"fill\", function () {\n//  let color =\n//    database[d3.select(this).attr(\"id\")] === undefined\n//      ? \"black\"\n//      : database[d3.select(this).attr(\"id\")].originalColor;\n//  return color;\n//})\n.attr(\"r\",globalDotSize).attr(\"opacity\",globalOpacity);// Remove point label\nd3.selectAll(\".pointLabel\").transition().duration(200).remove();// Reset lasso\nd3.selectAll(\"#lasso\").transition().duration(200).attr(\"d\",\"\");}// Make random id strings\nfunction makeid(length){var result=\"\";var characters=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";var charactersLength=characters.length;for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}return result;}function changeOpacity(opacity){d3.selectAll(\"circle\").attr(\"opacity\",opacity);globalOpacity=opacity;}function changeDotSize(dotSize){d3.selectAll(\"circle\").attr(\"r\",dotSize);globalDotSize=dotSize;}function changeDatset(name){dataset=name;}function highlightLabel(event){// Reset previously highlighted labels\nd3.selectAll(\".brushed\").transition().duration(200).attr(\"fill\",\"orange\").attr(\"opacity\",globalOpacity).attr(\"class\",\"brushed\").attr(\"r\",globalDotSize);var ids=event.target.id.split(\" \");// Highlight labels corresponding to ids\nvar _iterator3=_createForOfIteratorHelper(ids),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var id=_step3.value;d3.select(\"#\"+id).transition().duration(200).attr(\"fill\",\"green\").attr(\"class\",\"brushed selected\").attr(\"opacity\",globalOpacity+0.5).attr(\"r\",globalDotSize*3);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}// Draws tool tip for specific point on hover\nfunction drawToolTip(id,width){var pointInfo=database[id];var svg=d3.select(\"#containerSVG\");var toolTipWidth=340;var rectPadding=1;var hasCategory=database[id].originalColor!==\"black\"?true:false;// If dot is on right side of screen, flip tooltip\nvar leftflip=false;if(pointInfo.cx>width/2){leftflip=true;}// If dot is too high up, flip tooltip\nvar bottomflip=false;// Draw tooltip of label text with rectangular border\n// g element to hold the rect and text\nvar pointLabelContainer=svg.append(\"g\").attr(\"transform\",\"translate(\"+pointInfo.cx+\",\"+pointInfo.cy+\")\").attr(\"class\",\"pointLabel\").attr(\"id\",id+\"label\");// Text\nvar toytext=pointLabelContainer.append(\"text\").text(\"item: \"+pointInfo.label).attr(\"x\",function(){if(!leftflip){return rectPadding+\"em\";}else{return-toolTipWidth;}}).attr(\"y\",-60+rectPadding+12).attr(\"id\",\"toyText\");var lines=wrap(toytext,toolTipWidth-2*rectPadding);d3.select(\"#toyText\").remove();// Rect\nvar toolTipHeight=1.1*(lines+1)+1;// Flips tooltip if it's too close to the top\nif(pointInfo.cy<100){bottomflip=true;}if(hasCategory){toolTipHeight=1.1*(lines+4)+1;}pointLabelContainer.append(\"rect\").attr(\"x\",function(){if(!leftflip){return 10;}else{return-(toolTipWidth+10);}}).attr(\"y\",function(){if(!bottomflip){return-3+\"em\";}else{return 0;}}).attr(\"width\",toolTipWidth).attr(\"height\",toolTipHeight+\"em\").attr(\"fill\",\"white\").attr(\"stroke\",\"black\").attr(\"stroke-width\",\"1px\").style(\"z-index\",\"1\");// Change fill/size of the corresponding point\nd3.select(\"#\"+id).attr(\"fill\",\"green\").attr(\"opacity\",globalOpacity+0.5).attr(\"r\",globalDotSize*3);pointLabelContainer.append(\"text\").text(\"item: \"+pointInfo.label).attr(\"x\",function(){if(!leftflip){return rectPadding+\"em\";}else{return-toolTipWidth;}}).attr(\"y\",function(){if(!bottomflip){return-3+rectPadding+0.3+\"em\";}else{return rectPadding+0.3+\"em\";}}).style(\"z-index\",\"10\").attr(\"font-family\",\"Arial\").attr(\"fill\",\"black\").attr(\"stroke-width\",\"1px\").style(\"z-index\",\"10\").attr(\"vector-effect\",\"non-scaling-stroke\").call(wrap,toolTipWidth-2*10);// Add category information if has category\nif(hasCategory){pointLabelContainer.append(\"text\").text(\"category: \"+pointInfo.category).attr(\"x\",function(){if(!leftflip){return rectPadding+\"em\";}else{return-toolTipWidth;}}).attr(\"y\",function(){if(!bottomflip){return-3+toolTipHeight-1.1+\"em\";}else{return toolTipHeight-1.1+\"em\";}}).style(\"z-index\",\"10\").attr(\"font-family\",\"Arial\").attr(\"fill\",\"black\").attr(\"stroke-width\",\"1px\").style(\"z-index\",\"10\").attr(\"vector-effect\",\"non-scaling-stroke\");}}// Function for wrapping svg text elements\nfunction wrap(text,width){var lines=0;text.each(function(){var text=d3.select(this),words=text.text().split(/\\s+/).reverse(),word,line=[],lineNumber=0,lineHeight=1.1,// ems\nx=text.attr(\"x\"),y=text.attr(\"y\"),dy=0,//parseFloat(text.attr(\"dy\")),\ntspan=text.text(null).append(\"tspan\").attr(\"x\",x).attr(\"y\",y).attr(\"dy\",dy+\"em\");while(word=words.pop()){line.push(word);tspan.text(line.join(\" \"));if(tspan.node().getComputedTextLength()>width){line.pop();tspan.text(line.join(\" \"));line=[word];tspan=text.append(\"tspan\").attr(\"x\",x).attr(\"y\",y).attr(\"dy\",++lineNumber*lineHeight+dy+\"em\").text(word);}}lines=lineNumber;});return lines;}// Uses the ID of a point to remove the corresponding tooltip on mouseOut\nfunction eraseToolTip(id){var POINT_CLASS_NAME=d3.select(\"#\"+id).attr(\"class\");// Remove the tooltip\nd3.select(\"#\"+id+\"label\").remove();// Reset points to appropriate fill, opacity, and radius based on state\nd3.select(\"#\"+id).attr(\"fill\",function(){switch(POINT_CLASS_NAME){case\"brushed\":return\"orange\";case\"brushed selected\":return\"green\";case\"matches-substring brushed\":return\"orange\";default:return database[id].originalColor;//////////******fix if the state is that it is currently selected, then stay black */\n// return \"red\"\n}}).attr(\"opacity\",function(){switch(POINT_CLASS_NAME){case\"brushed\":return globalOpacity;case\"brushed selected\":return globalOpacity+0.5;default:return globalOpacity;}}).attr(\"r\",function(){switch(POINT_CLASS_NAME){case\"brushed\":return globalDotSize*5;case\"brushed selected\":return globalDotSize*5;default:return globalDotSize;}});}// Gets centroid of set of points\nfunction getCentroid(points){var first=points[0],last=points[points.length-1];if(first.x!==last.x||first.y!==last.y)points.push(first);var twicearea=0,x=0,y=0,nPoints=points.length,p1,p2,f;for(var i=0,j=nPoints-1;i<nPoints;j=i++){p1=points[i];p2=points[j];f=p1.x*p2.y-p2.x*p1.y;twicearea+=f;x+=(p1.x+p2.x)*f;y+=(p1.y+p2.y)*f;}f=twicearea*3;return{x:x/f,y:y/f};}function findMatchingPoints(substring){substring=substring.toLowerCase();// Changes opacity of dots to look like something's loading\n// d3.selectAll(\"circle\").attr(\"opacity\", 0.1);\n// TODO: make color black for colored plot\n// Highlight points whose labels match the substring\nvar COLORFUL=Object.entries(colorMap).length>0?true:false;d3.selectAll(\"circle\").filter(function(d){if(d[2]!==undefined){var lowerCaseLabel=d[2].toLowerCase();return lowerCaseLabel.includes(substring);}else{return false;}}).transition().duration(200).attr(\"fill\",function(d){if(COLORFUL){return\"black\";}else{return\"orange\";}}).attr(\"class\",\"matches-substring brushed\").attr(\"opacity\",globalOpacity);}function clearSelectedMatchingPoints(){d3.selectAll(\".matches-substring\").transition().duration(200).attr(\"class\",\"brushed\");}function showKeywords(colorMap){d3.selectAll(\"#keywords\").remove();var svg2=d3.select(\"#containerSVG\").raise();var x=colorMap.x;var y=colorMap.y;var id=\"keywords\";// Draw circles\nfor(var i=0;i<Object.keys(colorMap).length;i++){console.log(colorMap[i]);var array=colorMap[i];svg2.append(\"text\").attr(\"opacity\",1).attr(\"id\",id).attr(\"x\",x(+array[2][0])).attr(\"y\",y(+array[2][1])).attr(\"fill\",'black').attr(\"text-anchor\",\"middle\").attr(\"font-size\",\"0.5em\")//.text(\"hello\")\n.text(array[1]);}}export{drawProjection,drawTestProjection,checkPoints,autocheckPoints,reset,clearSVG,changeOpacity,changeDotSize,highlightLabel,drawToolTip,eraseToolTip,getCentroid,toggleDotDisplay,findMatchingPoints,clearSelectedMatchingPoints,changeDatset};","map":{"version":3,"names":["d3","database","colorMap","globalOpacity","globalDotSize","dataset","clearSVG","svg","select","selectAll","remove","attr","drawProjection","width","height","uploadedData","data","JSON","parse","stringify","MARGIN","top","right","bottom","left","SVG_X","SVG_Y","PLOT_X","PLOT_Y","x","scaleLinear","range","y","console","log","length","makeColorMap","d_extent_x","extent","d","d_extent_y","domain","row","push","makeid","enter","append","id","label","keyword","centerX","cx","centerY","cy","assignColor","originalColor","showKeywords","drawTestProjection","svg2","raise","transition","duration","uniqueCategories","Set","uniqueKeywords","uniqueClusterCentroids","item","has","add","categoriesArray","Array","from","keywordsArray","centroidsArray","i","COLORS","category","toggleDotDisplay","checked","filter","checkPoints","path","document","getElementById","getElementsByTagName","brushedPoints","categorizedPoints","selectedLabels","idInfo","point","createSVGPoint","isPointInFill","selector","CURRENT_CLASS","includes","elements","color","Object","entries","autocheckPoints","reset","result","characters","charactersLength","charAt","Math","floor","random","changeOpacity","opacity","changeDotSize","dotSize","changeDatset","name","highlightLabel","event","ids","target","split","drawToolTip","pointInfo","toolTipWidth","rectPadding","hasCategory","leftflip","bottomflip","pointLabelContainer","toytext","text","lines","wrap","toolTipHeight","style","call","each","words","reverse","word","line","lineNumber","lineHeight","dy","tspan","pop","join","node","getComputedTextLength","eraseToolTip","POINT_CLASS_NAME","getCentroid","points","first","last","twicearea","nPoints","p1","p2","f","j","findMatchingPoints","substring","toLowerCase","COLORFUL","undefined","lowerCaseLabel","clearSelectedMatchingPoints","keys","array"],"sources":["/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/Text-Cluster-Explainer/frontend/src/d3-rendering/projectionManipulationFunctions.js"],"sourcesContent":["import * as d3 from \"d3\";\n\n// Storing state location data for quicker access\n/*\n  Schema:\n  database = {\n    id: {\n      cx: float\n      cy: float\n      label: string\n      originalColor: color\n    }\n  }\n  */\n\n// Global variables\nlet database = {}; // Database of projected points\nlet colorMap = {}; // Map of label --> color\nlet globalOpacity = 0.5; // Default opacity\nlet globalDotSize = 2; // Default dot size\nlet dataset = \"\"\n\n// Clears SVG in the center panel when new data is uploaded\nfunction clearSVG() {\n  var svg = d3.select(\"#containerSVG\");\n  svg.selectAll(\"circle\").remove(); // Removes plotted points\n  svg.selectAll(\"#lasso\").attr(\"d\", \"\"); // Resets lasso\n}\n\n// Function to draw projection, called once at render time and when new data is uploaded\n/*\n  Schema:\n  width = float\n  height = float\n  uploadedData = [x, y, label, color(if color column selected)]\n*/\nfunction drawProjection(width, height, uploadedData) {\n  let data = JSON.parse(JSON.stringify(uploadedData));\n  // Location var\n  const MARGIN = { top: 20, right: 0, bottom: 50, left: 85 },\n    SVG_X = width,\n    SVG_Y = height,\n    PLOT_X = SVG_X - MARGIN.right - MARGIN.left,\n    PLOT_Y = SVG_Y - MARGIN.top - MARGIN.bottom;\n\n  let x = d3.scaleLinear().range([MARGIN.left, PLOT_X]),\n    y = d3.scaleLinear().range([PLOT_Y, MARGIN.top]);\n\n\n    \n  // SVG\n  var svg = d3.select(\"#containerSVG\")//.call(d3.zoom().on(\"zoom\", function handleZoom(event) { svg.attr(\"transform\",event.transform) }));\n  //d3.select(\"#containerSVG\").on('mousedown.zoom',null);\n  // Re-setting database and colorMap and using uploaded data to draw when data has been loaded\n  database = {};\n  colorMap = {};\n  console.log(data[0])\n  if (data[0].length === 6) {\n    makeColorMap(data);\n  }\n\n  var d_extent_x = d3.extent(data, (d) => +d[0]),\n    d_extent_y = d3.extent(data, (d) => +d[1]);\n\n  // Draw axes\n  x.domain(d_extent_x);\n  y.domain(d_extent_y);\n\n  // Generate IDs for points\n  for (let row of data) {\n    row.push(makeid(10));\n  }\n\n  // Draw circles\n  svg\n    .selectAll(\"circle\")\n    .data(data)\n    .enter()\n    .append(\"g\")\n    .append(\"circle\")\n    .attr(\"r\", globalDotSize)\n    .attr(\"opacity\", globalOpacity)\n    .attr(\"id\", (d) => {\n      let id = d[d.length - 1];\n      database[id] = { label: d[2], keyword:d[4]};\n      return id;\n    })\n    .attr(\"cx\", (d) => {\n      let centerX = x(+d[0]);\n      database[d[d.length - 1]].cx = centerX;\n      return centerX;\n    })\n    .attr(\"cy\", (d) => {\n      let centerY = y(+d[1]);\n      database[d[d.length - 1]].cy = centerY;\n      return centerY;\n    })\n    .attr(\"fill\", (d) => {\n      if (d.length === 7) {\n        return assignColor(d[3], d[6]);\n      } else {\n        database[d[d.length - 1]].originalColor = \"black\";\n        return \"black\";\n      }\n    })\n    .attr(\"class\", \"non-brushed\");\n  colorMap.x = x\n  colorMap.y = y\n  console.log(colorMap,x,y)\n  //svg.append(\"g\");\n  showKeywords(colorMap)\n  return colorMap;\n}\n\nfunction drawTestProjection(data) {\n  d3.select(\"#test_text\").remove();\n  var svg2 = d3.select(\"#containerSVG\").raise()\n  var x = colorMap.x \n  var y = colorMap.y\n  console.log(x,y)\n  let id = \"test_text\";\n  // Draw circles\n  svg2\n    .append(\"g\")\n    .selectAll(\"circle\")\n    .data(data)\n    .enter()\n    .append(\"circle\")\n    .attr(\"r\", 0)\n    .attr(\"opacity\", 1)\n    .attr(\"id\", id)\n    .attr(\"cx\", (d) => {\n      let centerX = x(+d[0]);\n      return centerX;\n    })\n    .attr(\"cy\", (d) => {\n      let centerY = y(+d[1]);\n      return centerY;\n    })\n    .attr(\"fill\", 'green').attr(\"class\", \"non-brushed\")\n    .transition().duration(200).attr(\"r\", 10)\n\n}\n\nfunction makeColorMap(data) {\n  let uniqueCategories = new Set();\n  let uniqueKeywords = new Set();\n  let uniqueClusterCentroids = new Set();\n\n\n  for (let item of data) {\n    \n    if (uniqueCategories.has(item[3])) {\n      continue;\n    } else {\n      uniqueCategories.add(item[3]);\n      uniqueKeywords.add(item[4]);\n      uniqueClusterCentroids.add(item[5]);\n    }\n  }\n  \n\n\n  let categoriesArray = Array.from(uniqueCategories);\n  let keywordsArray = Array.from(uniqueKeywords);\n  let centroidsArray = Array.from(uniqueClusterCentroids);\n\n  for (let i = 0; i < categoriesArray.length; i++) {\n    colorMap[categoriesArray[i]] = [COLORS[i % 11], keywordsArray[i], JSON.parse(centroidsArray[i])] ;\n  }\n  \n}\n\nconst COLORS = ['#e6194B', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#42d4f4', '#f032e6', '#bfef45', '#fabed4', '#469990', '#dcbeff', '#9A6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#a9a9a9', '#ffffff', '#000000'\n];\n\nfunction assignColor(category, id) {\n  database[id].category = category;\n  database[id].originalColor = colorMap[category][0];\n  return colorMap[category][0];\n}\n\n// Displays dots based on if the checkbox corresponding to their color is checked\nfunction toggleDotDisplay(checked, label) {\n  d3.selectAll(\"circle\")\n    .filter(function () {\n      if (database[d3.select(this).attr(\"id\")]) {\n        return database[d3.select(this).attr(\"id\")].category === +label;\n      } else {\n        return false;\n      }\n    }).transition().duration(200)\n    .attr(\"visibility\", function () {\n      if (checked) {\n        return \"visible\";\n      } else {\n        return \"hidden\";\n      }\n    })\n    .attr(\"opacity\", function () {\n      if (checked) {\n        return \"1\";\n      } else {\n        return \"0\";\n      }\n    });\n}\n\n// Check if points are within path on mouseup\nfunction checkPoints() {\n  var path = document.getElementById(\"lasso\");\n  let svg = document.getElementsByTagName(\"svg\")[0];\n  let brushedPoints = [];\n  let categorizedPoints = [];\n  let selectedLabels = [];\n  // d3.polygonContains(lassoPolygon, [x, y]);\n  for (let [id, idInfo] of Object.entries(database)) {\n    // Ignores point if it's not currently displayed\n    if (d3.select(\"#\" + id).attr(\"visibility\") === \"hidden\") {\n      continue;\n    }\n    const point = svg.createSVGPoint();\n\n    point.x = idInfo.cx;\n    point.y = idInfo.cy;\n    // Check if point is in path\n    if (path.isPointInFill(point)) {\n      idInfo.id = id;\n      brushedPoints.push(idInfo);\n      categorizedPoints.push([idInfo.label, 1]);\n      selectedLabels.push(idInfo.label);\n      // Change class and recolor points accordingly\n      let selector = \"#\" + id;\n      d3.selectAll(selector)\n        .attr(\"class\", function () {\n          const CURRENT_CLASS = d3.select(this).attr(\"class\");\n          if (CURRENT_CLASS.includes(\"brushed\")) {\n            return CURRENT_CLASS;\n          } else {\n            return \"brushed\";\n          }\n        })\n        .attr(\"fill\", (d, i, elements) => {\n          let color = database[id].originalColor;\n          if (d3.select(elements[i]).attr(\"class\").includes(\"brushed\")) {\n            if (Object.entries(colorMap).length > 0) {\n              color = \"black\"; \n              //color = \"red\"\n            } else {\n              color = \"orange\";\n            }\n          }\n\n          return color;\n        });\n    } else categorizedPoints.push([idInfo.label, 0]);\n  }\n\n  return {\n    brushedPoints: brushedPoints,\n    categorizedPoints: categorizedPoints,\n    selectedLabels: selectedLabels,\n  };\n}\n\nfunction autocheckPoints(label) {\n  console.log(\"in auto checkpoints\")\n  let brushedPoints = [];\n  let categorizedPoints = [];\n  let selectedLabels = [];\n  // d3.polygonContains(lassoPolygon, [x, y]);\n\n  for (let [id, idInfo] of Object.entries(database)) {\n    // Ignores point if it's not currently displayed\n    let selector = \"#\" + id;\n    if (database[id].category === +label) {\n      idInfo.id = id;\n      brushedPoints.push(idInfo);\n      categorizedPoints.push([idInfo.label, 1]);\n      selectedLabels.push(idInfo.label);\n\n      \n      d3.selectAll(selector).transition().duration(200)\n          .attr('r', 3*globalDotSize).attr(\"opacity\", 1)\n      \n    } else {categorizedPoints.push([idInfo.label, 0]);\n      d3.selectAll(selector).transition().duration(200)\n      .attr('r', globalDotSize).attr(\"opacity\", globalOpacity)}\n  }\n\n  return {\n    brushedPoints: brushedPoints,\n    categorizedPoints: categorizedPoints,\n    selectedLabels: selectedLabels,\n  };\n}\n// Reset projection to original state\nfunction reset() {\n  // Remove word clouds\n  d3.select(\"#positive-cloud\").remove();\n  d3.select(\"#negative-cloud\").remove();\n\n  // Re-color points\n  d3.selectAll(\"circle\")\n    .filter(function () {\n      if (d3.select(this).attr(\"class\").includes(\"matches-substring\")) {\n        return false;\n      } else {\n        return true;\n      }\n    })\n    .attr(\"class\", \"prev-brushed\").transition().duration(200)\n    //.attr(\"fill\", function () {\n    //  let color =\n    //    database[d3.select(this).attr(\"id\")] === undefined\n    //      ? \"black\"\n    //      : database[d3.select(this).attr(\"id\")].originalColor;\n    //  return color;\n    //})\n    .attr(\"r\", globalDotSize)\n    .attr(\"opacity\", globalOpacity);\n\n  // Remove point label\n  d3.selectAll(\".pointLabel\").transition().duration(200).remove();\n\n  // Reset lasso\n  d3.selectAll(\"#lasso\").transition().duration(200).attr(\"d\", \"\");\n}\n\n// Make random id strings\nfunction makeid(length) {\n  var result = \"\";\n  var characters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\";\n  var charactersLength = characters.length;\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n}\n\nfunction changeOpacity(opacity) {\n  d3.selectAll(\"circle\").attr(\"opacity\", opacity);\n  globalOpacity = opacity;\n}\nfunction changeDotSize(dotSize) {\n  d3.selectAll(\"circle\").attr(\"r\", dotSize);\n  globalDotSize = dotSize;\n}\n\nfunction changeDatset(name) {\n  dataset = name;\n}\n\nfunction highlightLabel(event) {\n  // Reset previously highlighted labels\n  d3.selectAll(\".brushed\").transition().duration(200)\n    .attr(\"fill\", \"orange\")\n    .attr(\"opacity\", globalOpacity)\n    .attr(\"class\", \"brushed\")\n    .attr(\"r\", globalDotSize);\n  let ids = event.target.id.split(\" \");\n\n  // Highlight labels corresponding to ids\n  for (let id of ids) {\n    d3.select(\"#\" + id).transition().duration(200)\n      .attr(\"fill\", \"green\")\n      .attr(\"class\", \"brushed selected\")\n      .attr(\"opacity\", globalOpacity + 0.5)\n      .attr(\"r\", globalDotSize*3);\n  }\n}\n\n// Draws tool tip for specific point on hover\nfunction drawToolTip(id, width) {\n  let pointInfo = database[id];\n  let svg = d3.select(\"#containerSVG\");\n  let toolTipWidth = 340;\n  let rectPadding = 1;\n  let hasCategory = database[id].originalColor !== \"black\" ? true : false;\n\n  // If dot is on right side of screen, flip tooltip\n  let leftflip = false;\n  if (pointInfo.cx > width / 2) {\n    leftflip = true;\n  }\n\n  // If dot is too high up, flip tooltip\n  let bottomflip = false;\n\n  // Draw tooltip of label text with rectangular border\n  // g element to hold the rect and text\n  var pointLabelContainer = svg\n    .append(\"g\")\n    .attr(\"transform\", \"translate(\" + pointInfo.cx + \",\" + pointInfo.cy + \")\")\n    .attr(\"class\", \"pointLabel\")\n    .attr(\"id\", id + \"label\");\n\n  // Text\n  let toytext = pointLabelContainer\n    .append(\"text\")\n    .text(\"item: \" + pointInfo.label)\n    .attr(\"x\", () => {\n      if (!leftflip) {\n        return rectPadding + \"em\";\n      } else {\n        return -toolTipWidth;\n      }\n    })\n    .attr(\"y\", -60 + rectPadding + 12)\n    .attr(\"id\", \"toyText\");\n\n  let lines = wrap(toytext, toolTipWidth - 2 * rectPadding);\n\n  d3.select(\"#toyText\").remove();\n\n  // Rect\n  let toolTipHeight = 1.1 * (lines + 1) + 1;\n\n  // Flips tooltip if it's too close to the top\n  if (pointInfo.cy < 100) {\n    bottomflip = true;\n  }\n\n  if (hasCategory) {\n    toolTipHeight = 1.1 * (lines + 4) + 1;\n  }\n\n  pointLabelContainer\n    .append(\"rect\")\n    .attr(\"x\", () => {\n      if (!leftflip) {\n        return 10;\n      } else {\n        return -(toolTipWidth + 10);\n      }\n    })\n    .attr(\"y\", () => {\n      if (!bottomflip) {\n        return -3 + \"em\";\n      } else {\n        return 0;\n      }\n    })\n    .attr(\"width\", toolTipWidth)\n    .attr(\"height\", toolTipHeight + \"em\")\n    .attr(\"fill\", \"white\")\n    .attr(\"stroke\", \"black\")\n    .attr(\"stroke-width\", \"1px\")\n    .style(\"z-index\", \"1\");\n\n  // Change fill/size of the corresponding point\n  d3.select(\"#\" + id)\n    .attr(\"fill\", \"green\")\n    .attr(\"opacity\", globalOpacity + 0.5)\n    .attr(\"r\", globalDotSize*3);\n\n  pointLabelContainer\n    .append(\"text\")\n    .text(\"item: \" + pointInfo.label)\n    .attr(\"x\", () => {\n      if (!leftflip) {\n        return rectPadding + \"em\";\n      } else {\n        return -toolTipWidth;\n      }\n    })\n    .attr(\"y\", () => {\n      if (!bottomflip) {\n        return -3 + rectPadding + 0.3 + \"em\";\n      } else {\n        return rectPadding + 0.3 + \"em\";\n      }\n    })\n    .style(\"z-index\", \"10\")\n    .attr(\"font-family\", \"Arial\")\n    .attr(\"fill\", \"black\")\n    .attr(\"stroke-width\", \"1px\")\n    .style(\"z-index\", \"10\")\n    .attr(\"vector-effect\", \"non-scaling-stroke\")\n    .call(wrap, toolTipWidth - 2 * 10);\n\n  // Add category information if has category\n  if (hasCategory) {\n    pointLabelContainer\n      .append(\"text\")\n      .text(\"category: \" + pointInfo.category)\n      .attr(\"x\", () => {\n        if (!leftflip) {\n          return rectPadding + \"em\";\n        } else {\n          return -toolTipWidth;\n        }\n      })\n      .attr(\"y\", () => {\n        if (!bottomflip) {\n          return -3 + toolTipHeight - 1.1 + \"em\";\n        } else {\n          return toolTipHeight - 1.1 + \"em\";\n        }\n      })\n      .style(\"z-index\", \"10\")\n      .attr(\"font-family\", \"Arial\")\n      .attr(\"fill\", \"black\")\n      .attr(\"stroke-width\", \"1px\")\n      .style(\"z-index\", \"10\")\n      .attr(\"vector-effect\", \"non-scaling-stroke\");\n  }\n}\n\n// Function for wrapping svg text elements\nfunction wrap(text, width) {\n  let lines = 0;\n  text.each(function () {\n    var text = d3.select(this),\n      words = text.text().split(/\\s+/).reverse(),\n      word,\n      line = [],\n      lineNumber = 0,\n      lineHeight = 1.1, // ems\n      x = text.attr(\"x\"),\n      y = text.attr(\"y\"),\n      dy = 0, //parseFloat(text.attr(\"dy\")),\n      tspan = text\n        .text(null)\n        .append(\"tspan\")\n        .attr(\"x\", x)\n        .attr(\"y\", y)\n        .attr(\"dy\", dy + \"em\");\n    while ((word = words.pop())) {\n      line.push(word);\n      tspan.text(line.join(\" \"));\n      if (tspan.node().getComputedTextLength() > width) {\n        line.pop();\n        tspan.text(line.join(\" \"));\n        line = [word];\n        tspan = text\n          .append(\"tspan\")\n          .attr(\"x\", x)\n          .attr(\"y\", y)\n          .attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\")\n          .text(word);\n      }\n    }\n    lines = lineNumber;\n  });\n\n  return lines;\n}\n\n// Uses the ID of a point to remove the corresponding tooltip on mouseOut\nfunction eraseToolTip(id) {\n  const POINT_CLASS_NAME = d3.select(\"#\" + id).attr(\"class\");\n\n  // Remove the tooltip\n  d3.select(\"#\" + id + \"label\").remove();\n\n  // Reset points to appropriate fill, opacity, and radius based on state\n  d3.select(\"#\" + id)\n    .attr(\"fill\", () => {\n      switch (POINT_CLASS_NAME) {\n        case \"brushed\":\n          return \"orange\";\n        case \"brushed selected\":\n          return \"green\";\n        case \"matches-substring brushed\":\n          return \"orange\";\n        default:\n          return database[id].originalColor; //////////******fix if the state is that it is currently selected, then stay black */\n          // return \"red\"\n      }\n    })\n    .attr(\"opacity\", () => {\n      switch (POINT_CLASS_NAME) {\n        case \"brushed\":\n          return globalOpacity;\n        case \"brushed selected\":\n          return globalOpacity + 0.5;\n        default:\n          return globalOpacity;\n      }\n    })\n    .attr(\"r\", () => {\n      switch (POINT_CLASS_NAME) {\n        case \"brushed\":\n          return globalDotSize*5;\n        case \"brushed selected\":\n          return globalDotSize*5;\n        default:\n          return globalDotSize;\n      }\n    });\n}\n\n// Gets centroid of set of points\nfunction getCentroid(points) {\n  var first = points[0],\n    last = points[points.length - 1];\n  if (first.x !== last.x || first.y !== last.y) points.push(first);\n  var twicearea = 0,\n    x = 0,\n    y = 0,\n    nPoints = points.length,\n    p1,\n    p2,\n    f;\n  for (var i = 0, j = nPoints - 1; i < nPoints; j = i++) {\n    p1 = points[i];\n    p2 = points[j];\n    f = p1.x * p2.y - p2.x * p1.y;\n    twicearea += f;\n    x += (p1.x + p2.x) * f;\n    y += (p1.y + p2.y) * f;\n  }\n  f = twicearea * 3;\n  return { x: x / f, y: y / f };\n}\n\nfunction findMatchingPoints(substring) {\n  substring = substring.toLowerCase();\n  // Changes opacity of dots to look like something's loading\n  // d3.selectAll(\"circle\").attr(\"opacity\", 0.1);\n\n  // TODO: make color black for colored plot\n  // Highlight points whose labels match the substring\n  const COLORFUL = Object.entries(colorMap).length > 0 ? true : false;\n\n  d3.selectAll(\"circle\")\n    .filter(function (d) {\n      if (d[2] !== undefined) {\n        let lowerCaseLabel = d[2].toLowerCase();\n        return lowerCaseLabel.includes(substring);\n      } else {\n        return false;\n      }\n    }).transition().duration(200)\n    .attr(\"fill\", function (d) {\n      if (COLORFUL) {\n        return \"black\";\n      } else {\n        return \"orange\";\n      }\n    })\n    .attr(\"class\", \"matches-substring brushed\")\n    .attr(\"opacity\", globalOpacity);\n}\n\nfunction clearSelectedMatchingPoints() {\n  d3.selectAll(\".matches-substring\").transition().duration(200).attr(\"class\", \"brushed\");\n}\n\n\n\nfunction showKeywords(colorMap) {\n  d3.selectAll(\"#keywords\").remove()\n  var svg2 = d3.select(\"#containerSVG\").raise()\n  var x = colorMap.x \n  var y = colorMap.y\n  let id = \"keywords\";\n  // Draw circles\n\n  for (let i = 0; i < Object.keys(colorMap).length; i++) {\n    console.log(colorMap[i])\n    let array = colorMap[i]\n  \n  svg2\n    .append(\"text\")\n    .attr(\"opacity\", 1)\n    .attr(\"id\", id)\n    .attr(\"x\", x(+array[2][0]))\n    .attr(\"y\", y(+array[2][1]))\n    .attr(\"fill\", 'black')\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", \"0.5em\")//.text(\"hello\")\n    .text(array[1])\n\n  }\n}\n\n\nexport {\n  drawProjection,\n  drawTestProjection,\n  checkPoints,\n  autocheckPoints,\n  reset,\n  clearSVG,\n  changeOpacity,\n  changeDotSize,\n  highlightLabel,\n  drawToolTip,\n  eraseToolTip,\n  getCentroid,\n  toggleDotDisplay,\n  findMatchingPoints,\n  clearSelectedMatchingPoints,\n  changeDatset\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}